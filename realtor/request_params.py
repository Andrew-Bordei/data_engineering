PAYLOAD = "{\"query\":\"query ConsumerSearchQuery($query: HomeSearchCriteria!, $limit: Int, $offset: Int, $search_promotion: SearchPromotionInput, $sort: [SearchAPISort], $sort_type: SearchSortType, $client_data: JSON, $bucket: SearchAPIBucket, $mortgage_params: MortgageParamsInput, $photosLimit: Int) {\\n  home_search: home_search(\\n    query: $query\\n    sort: $sort\\n    limit: $limit\\n    offset: $offset\\n    sort_type: $sort_type\\n    client_data: $client_data\\n    bucket: $bucket\\n    search_promotion: $search_promotion\\n    mortgage_params: $mortgage_params\\n  ) {\\n    count\\n    total\\n    search_promotion {\\n      names\\n      slots\\n      promoted_properties {\\n        id\\n        from_other_page\\n        __typename\\n      }\\n      __typename\\n    }\\n    mortgage_params {\\n      interest_rate\\n      __typename\\n    }\\n    properties: results {\\n      property_id\\n      list_price\\n      rmn_listing_attribution\\n      search_promotions {\\n        name\\n        asset_id\\n        __typename\\n      }\\n      primary_photo(https: true) {\\n        href\\n        __typename\\n      }\\n      listing_id\\n      matterport\\n      virtual_tours {\\n        href\\n        type\\n        __typename\\n      }\\n      status\\n      products {\\n        products\\n        brand_name\\n        __typename\\n      }\\n      source {\\n        id\\n        name\\n        type\\n        spec_id\\n        plan_id\\n        agents {\\n          office_name\\n          __typename\\n        }\\n        listing_id\\n        __typename\\n      }\\n      lead_attributes {\\n        show_contact_an_agent\\n        market_type\\n        opcity_lead_attributes {\\n          cashback_enabled\\n          flip_the_market_enabled\\n          __typename\\n        }\\n        lead_type\\n        ready_connect_mortgage {\\n          show_contact_a_lender\\n          show_veterans_united\\n          __typename\\n        }\\n        __typename\\n      }\\n      community {\\n        description {\\n          name\\n          __typename\\n        }\\n        property_id\\n        permalink\\n        advertisers {\\n          office {\\n            hours\\n            phones {\\n              type\\n              number\\n              primary\\n              trackable\\n              __typename\\n            }\\n            __typename\\n          }\\n          __typename\\n        }\\n        promotions {\\n          description\\n          href\\n          headline\\n          promotion_type\\n          __typename\\n        }\\n        __typename\\n      }\\n      permalink\\n      price_reduced_amount\\n      description {\\n        name\\n        beds\\n        baths_consolidated\\n        sqft\\n        lot_sqft\\n        baths_max\\n        baths_min\\n        beds_min\\n        beds_max\\n        sqft_min\\n        sqft_max\\n        type\\n        sub_type\\n        sold_price\\n        sold_date\\n        year_built\\n        garage\\n        __typename\\n      }\\n      location {\\n        street_view_url\\n        address {\\n          line\\n          postal_code\\n          state\\n          state_code\\n          city\\n          coordinate {\\n            lat\\n            lon\\n            __typename\\n          }\\n          __typename\\n        }\\n        county {\\n          name\\n          fips_code\\n          __typename\\n        }\\n        __typename\\n      }\\n      open_houses {\\n        start_date\\n        end_date\\n        __typename\\n      }\\n      branding {\\n        type\\n        name\\n        photo\\n        __typename\\n      }\\n      flags {\\n        is_coming_soon\\n        is_new_listing(days: 14)\\n        is_price_reduced(days: 30)\\n        is_foreclosure\\n        is_new_construction\\n        is_pending\\n        is_contingent\\n        __typename\\n      }\\n      list_date\\n      photos(limit: $photosLimit, https: true) {\\n        href\\n        __typename\\n      }\\n      advertisers {\\n        type\\n        fulfillment_id\\n        name\\n        builder {\\n          name\\n          href\\n          logo\\n          fulfillment_id\\n          __typename\\n        }\\n        email\\n        office {\\n          name\\n          __typename\\n        }\\n        phones {\\n          number\\n          __typename\\n        }\\n        __typename\\n      }\\n      consumer_advertisers {\\n        type\\n        agent_id\\n        name\\n        __typename\\n      }\\n      last_status_change_date\\n      last_price_change_amount\\n      __typename\\n    }\\n    __typename\\n  }\\n  commute_polygon: get_commute_polygon(query: $query) {\\n    areas {\\n      id\\n      breakpoints {\\n        width\\n        height\\n        zoom\\n        __typename\\n      }\\n      radius\\n      center {\\n        lat\\n        lng\\n        __typename\\n      }\\n      __typename\\n    }\\n    boundary\\n    __typename\\n  }\\n}\",\"variables\":{\"photosLimit\":3,\"query\":{\"primary\":true,\"status\":[\"for_sale\",\"ready_to_build\"],\"search_location\":{\"location\":\"{city}, {state_abbr}\"}},\"client_data\":{\"device_data\":{\"device_type\":\"mobile\"}},\"limit\":42,\"offset\":42,\"sort_type\":\"relevant\",\"bucket\":{\"sort\":\"fractal_v6.5.0\"},\"search_promotion\":{\"names\":[\"CITY\",\"POSTALCODECITY\"],\"slots\":[],\"promoted_properties\":[[]]}}}"



def create_payload(city: str, state_abbr: str) -> dict[str, any]: 
    payload = {
        "query": "query ConsumerSearchQuery($query: HomeSearchCriteria!, $limit: Int, $offset: Int, $search_promotion: SearchPromotionInput, $sort: [SearchAPISort], $sort_type: SearchSortType, $client_data: JSON, $bucket: SearchAPIBucket, $mortgage_params: MortgageParamsInput, $photosLimit: Int) {\n  home_search: home_search(\n    query: $query\n    sort: $sort\n    limit: $limit\n    offset: $offset\n    sort_type: $sort_type\n    client_data: $client_data\n    bucket: $bucket\n    search_promotion: $search_promotion\n    mortgage_params: $mortgage_params\n  ) {\n    count\n    total\n    search_promotion {\n      names\n      slots\n      promoted_properties {\n        id\n        from_other_page\n        __typename\n      }\n      __typename\n    }\n    mortgage_params {\n      interest_rate\n      __typename\n    }\n    properties: results {\n      property_id\n      list_price\n      rmn_listing_attribution\n      search_promotions {\n        name\n        asset_id\n        __typename\n      }\n      primary_photo(https: true) {\n        href\n        __typename\n      }\n      listing_id\n      matterport\n      virtual_tours {\n        href\n        type\n        __typename\n      }\n      status\n      products {\n        products\n        brand_name\n        __typename\n      }\n      source {\n        id\n        name\n        type\n        spec_id\n        plan_id\n        agents {\n          office_name\n          __typename\n        }\n        listing_id\n        __typename\n      }\n      lead_attributes {\n        show_contact_an_agent\n        market_type\n        opcity_lead_attributes {\n          cashback_enabled\n          flip_the_market_enabled\n          __typename\n        }\n        lead_type\n        ready_connect_mortgage {\n          show_contact_a_lender\n          show_veterans_united\n          __typename\n        }\n        __typename\n      }\n      community {\n        description {\n          name\n          __typename\n        }\n        property_id\n        permalink\n        advertisers {\n          office {\n            hours\n            phones {\n              type\n              number\n              primary\n              trackable\n              __typename\n            }\n            __typename\n          }\n          __typename\n        }\n        promotions {\n          description\n          href\n          headline\n          promotion_type\n          __typename\n        }\n        __typename\n      }\n      permalink\n      price_reduced_amount\n      description {\n        name\n        beds\n        baths_consolidated\n        sqft\n        lot_sqft\n        baths_max\n        baths_min\n        beds_min\n        beds_max\n        sqft_min\n        sqft_max\n        type\n        sub_type\n        sold_price\n        sold_date\n        year_built\n        garage\n        __typename\n      }\n      location {\n        street_view_url\n        address {\n          line\n          postal_code\n          state\n          state_code\n          city\n          coordinate {\n            lat\n            lon\n            __typename\n          }\n          __typename\n        }\n        county {\n          name\n          fips_code\n          __typename\n        }\n        __typename\n      }\n      open_houses {\n        start_date\n        end_date\n        __typename\n      }\n      branding {\n        type\n        name\n        photo\n        __typename\n      }\n      flags {\n        is_coming_soon\n        is_new_listing(days: 14)\n        is_price_reduced(days: 30)\n        is_foreclosure\n        is_new_construction\n        is_pending\n        is_contingent\n        __typename\n      }\n      list_date\n      photos(limit: $photosLimit, https: true) {\n        href\n        __typename\n      }\n      advertisers {\n        type\n        fulfillment_id\n        name\n        builder {\n          name\n          href\n          logo\n          fulfillment_id\n          __typename\n        }\n        email\n        office {\n          name\n          __typename\n        }\n        phones {\n          number\n          __typename\n        }\n        __typename\n      }\n      consumer_advertisers {\n        type\n        agent_id\n        name\n        __typename\n      }\n      last_status_change_date\n      last_price_change_amount\n      __typename\n    }\n    __typename\n  }\n  commute_polygon: get_commute_polygon(query: $query) {\n    areas {\n      id\n      breakpoints {\n        width\n        height\n        zoom\n        __typename\n      }\n      radius\n      center {\n        lat\n        lng\n        __typename\n      }\n      __typename\n    }\n    boundary\n    __typename\n  }\n}",
        "variables": {
            "photosLimit": 3,
            "query": {
            "primary": True,
            "status": [
                "for_sale",
                "ready_to_build"
            ],
            "search_location": {"location": f"{city}, {state_abbr}"}}},
            "client_data": {"device_data": {"device_type": "mobile"}},
            "limit": 42,
            "offset": 42,
            "sort_type": "relevant",
            "bucket": {"sort": "fractal_v6.5.0"},
            "search_promotion": {
                "names": ["CITY","POSTALCODECITY"],
                "slots": [],
                "promoted_properties": []
            }
    }
    return payload

URL = "https://www.realtor.com/frontdoor/graphql"
